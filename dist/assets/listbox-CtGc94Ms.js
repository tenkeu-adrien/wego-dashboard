import{K as U,Q as Ee,u as $e,y as G,a as Re,a1 as ye,o as m,I as Ie,U as Pe,$ as Le,e as Me,N as Te,_ as pe,O as De,L as H,x as we,n as Ce,g as ke,h as _e,i as J,m as Fe,j as Ae,k as Be,a2 as Ne,R as Qe,f as Ke,p as fe,a0 as Ve,q as Ue,r as Ge,s as He,a6 as ze,t as je,l as se,v as qe,A as Je,B as Xe,C as Ze,T as We,D as Ye,d as K,E as et,F as tt,M as nt,G as ot,H as at,P as de,c as $,J as it,b as I,Z as rt,a3 as lt,a4 as ce,S as re,V as st,a7 as ut,a8 as dt}from"./use-text-value-BiuV3PYH.js";import{a as d,R as T,Q as B}from"./index-CMT_1ivQ.js";function Ft({children:e,freeze:n}){let a=ve(n,e);return T.createElement(T.Fragment,null,a)}function ve(e,n){let[a,t]=d.useState(n);return!e&&a!==n&&t(n),e?a:n}var ct=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ct||{}),pt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(pt||{}),ft=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ft||{}),vt=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetOptionsElement=8]="SetOptionsElement",e))(vt||{});function le(e,n=a=>a){let a=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=st(n(e.options.slice()),x=>x.dataRef.current.domRef.current),i=a?t.indexOf(a):null;return i===-1&&(i=null),{options:t,activeOptionIndex:i}}let bt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let n=e.activeOptionIndex,{isSelected:a}=e.dataRef.current,t=e.options.findIndex(i=>a(i.dataRef.current.value));return t!==-1&&(n=t),{...e,listboxState:0,activeOptionIndex:n,__demoMode:!1}},2(e,n){var a,t,i,x,S;if(e.dataRef.current.disabled||e.listboxState===1)return e;let p={...e,searchQuery:"",activationTrigger:(a=n.trigger)!=null?a:1,__demoMode:!1};if(n.focus===$.Nothing)return{...p,activeOptionIndex:null};if(n.focus===$.Specific)return{...p,activeOptionIndex:e.options.findIndex(u=>u.id===n.id)};if(n.focus===$.Previous){let u=e.activeOptionIndex;if(u!==null){let c=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((t=c.current)==null?void 0:t.previousElementSibling)===v.current||((i=v.current)==null?void 0:i.previousElementSibling)===null)return{...p,activeOptionIndex:g}}}}else if(n.focus===$.Next){let u=e.activeOptionIndex;if(u!==null){let c=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((x=c.current)==null?void 0:x.nextElementSibling)===v.current||((S=v.current)==null?void 0:S.nextElementSibling)===null)return{...p,activeOptionIndex:g}}}}let s=le(e),O=re(n,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...p,...s,activeOptionIndex:O}},3:(e,n)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let a=e.searchQuery!==""?0:1,t=e.searchQuery+n.value.toLowerCase(),i=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+a).concat(e.options.slice(0,e.activeOptionIndex+a)):e.options).find(S=>{var p;return!S.dataRef.current.disabled&&((p=S.dataRef.current.textValue)==null?void 0:p.startsWith(t))}),x=i?e.options.indexOf(i):-1;return x===-1||x===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:x,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,n)=>{let a={id:n.id,dataRef:n.dataRef},t=le(e,i=>[...i,a]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(a)),{...e,...t}},6:(e,n)=>{let a=le(e,t=>{let i=t.findIndex(x=>x.id===n.id);return i!==-1&&t.splice(i,1),t});return{...e,...a,activationTrigger:1}},7:(e,n)=>e.buttonElement===n.element?e:{...e,buttonElement:n.element},8:(e,n)=>e.optionsElement===n.element?e:{...e,optionsElement:n.element}},ue=d.createContext(null);ue.displayName="ListboxActionsContext";function X(e){let n=d.useContext(ue);if(n===null){let a=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,X),a}return n}let Z=d.createContext(null);Z.displayName="ListboxDataContext";function z(e){let n=d.useContext(Z);if(n===null){let a=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,z),a}return n}function xt(e,n){return K(n.type,bt,e,n)}let mt=d.Fragment;function Ot(e,n){var a;let t=Xe(),{value:i,defaultValue:x,form:S,name:p,onChange:s,by:O,invalid:u=!1,disabled:c=t||!1,horizontal:g=!1,multiple:v=!1,__demoMode:o=!1,...h}=e;const A=g?"horizontal":"vertical";let k=G(n),P=Ze(x),[R=v?[]:void 0,L]=We(i,s,P),[w,E]=d.useReducer(xt,{dataRef:d.createRef(),listboxState:o?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,buttonElement:null,optionsElement:null,__demoMode:o}),_=d.useRef({static:!1,hold:!1}),F=d.useRef(new Map),b=Ye(O),D=d.useCallback(f=>K(r.mode,{1:()=>R.some(y=>b(y,f)),0:()=>b(R,f)}),[R]),r=d.useMemo(()=>({...w,value:R,disabled:c,invalid:u,mode:v?1:0,orientation:A,compare:b,isSelected:D,optionsPropsRef:_,listRef:F}),[R,c,u,v,w,F]);se(()=>{w.dataRef.current=r},[r]);let N=r.listboxState===0;et(N,[r.buttonElement,r.optionsElement],(f,y)=>{var C;E({type:1}),ut(y,dt.Loose)||(f.preventDefault(),(C=r.buttonElement)==null||C.focus())});let W=d.useMemo(()=>({open:r.listboxState===0,disabled:c,invalid:u,value:R}),[r,c,R,u]),Y=m(f=>{let y=r.options.find(C=>C.id===f);y&&V(y.dataRef.current.value)}),ee=m(()=>{if(r.activeOptionIndex!==null){let{dataRef:f,id:y}=r.options[r.activeOptionIndex];V(f.current.value),E({type:2,focus:$.Specific,id:y})}}),te=m(()=>E({type:0})),j=m(()=>E({type:1})),q=fe(),ne=m((f,y,C)=>{q.dispose(),q.microTask(()=>f===$.Specific?E({type:2,focus:$.Specific,id:y,trigger:C}):E({type:2,focus:f,trigger:C}))}),oe=m((f,y)=>(E({type:5,id:f,dataRef:y}),()=>E({type:6,id:f}))),V=m(f=>K(r.mode,{0(){return L==null?void 0:L(f)},1(){let y=r.value.slice(),C=y.findIndex(he=>b(he,f));return C===-1?y.push(f):y.splice(C,1),L==null?void 0:L(y)}})),ae=m(f=>E({type:3,value:f})),l=m(()=>E({type:4})),M=m(f=>{E({type:7,element:f})}),Q=m(f=>{E({type:8,element:f})}),ie=d.useMemo(()=>({onChange:V,registerOption:oe,goToOption:ne,closeListbox:j,openListbox:te,selectActiveOption:ee,selectOption:Y,search:ae,clearSearch:l,setButtonElement:M,setOptionsElement:Q}),[]),[xe,me]=tt({inherit:!0}),Oe={ref:k},Se=d.useCallback(()=>{if(P!==void 0)return L==null?void 0:L(P)},[L,P]),ge=H();return T.createElement(me,{value:xe,props:{htmlFor:(a=r.buttonElement)==null?void 0:a.id},slot:{open:r.listboxState===0,disabled:c}},T.createElement(nt,null,T.createElement(ue.Provider,{value:ie},T.createElement(Z.Provider,{value:r},T.createElement(ot,{value:K(r.listboxState,{0:J.Open,1:J.Closed})},p!=null&&R!=null&&T.createElement(at,{disabled:c,data:{[p]:R},form:S,onReset:Se}),ge({ourProps:Oe,theirProps:h,slot:W,defaultTag:mt,name:"Listbox"}))))))}let St="button";function gt(e,n){var a;let t=z("Listbox.Button"),i=X("Listbox.Button"),x=d.useId(),S=$e(),{id:p=S||`headlessui-listbox-button-${x}`,disabled:s=t.disabled||!1,autoFocus:O=!1,...u}=e,c=G(n,Re(),i.setButtonElement),g=ye(),v=m(r=>{switch(r.key){case I.Enter:rt(r.currentTarget);break;case I.Space:case I.ArrowDown:r.preventDefault(),B.flushSync(()=>i.openListbox()),t.value||i.goToOption($.First);break;case I.ArrowUp:r.preventDefault(),B.flushSync(()=>i.openListbox()),t.value||i.goToOption($.Last);break}}),o=m(r=>{switch(r.key){case I.Space:r.preventDefault();break}}),h=m(r=>{var N;if(it(r.currentTarget))return r.preventDefault();t.listboxState===0?(B.flushSync(()=>i.closeListbox()),(N=t.buttonElement)==null||N.focus({preventScroll:!0})):(r.preventDefault(),i.openListbox())}),A=m(r=>r.preventDefault()),k=Ie([p]),P=Pe(),{isFocusVisible:R,focusProps:L}=Le({autoFocus:O}),{isHovered:w,hoverProps:E}=Me({isDisabled:s}),{pressed:_,pressProps:F}=Te({disabled:s}),b=d.useMemo(()=>({open:t.listboxState===0,active:_||t.listboxState===0,disabled:s,invalid:t.invalid,value:t.value,hover:w,focus:R,autofocus:O}),[t.listboxState,t.value,s,w,R,_,t.invalid,O]),D=pe(g(),{ref:c,id:p,type:De(e,t.buttonElement),"aria-haspopup":"listbox","aria-controls":(a=t.optionsElement)==null?void 0:a.id,"aria-expanded":t.listboxState===0,"aria-labelledby":k,"aria-describedby":P,disabled:s||void 0,autoFocus:O,onKeyDown:v,onKeyUp:o,onKeyPress:A,onClick:h},L,E,F);return H()({ourProps:D,theirProps:u,slot:b,defaultTag:St,name:"Listbox.Button"})}let be=d.createContext(!1),ht="div",Et=de.RenderStrategy|de.Static;function $t(e,n){var a,t;let i=d.useId(),{id:x=`headlessui-listbox-options-${i}`,anchor:S,portal:p=!1,modal:s=!0,transition:O=!1,...u}=e,c=we(S),[g,v]=d.useState(null);c&&(p=!0);let o=z("Listbox.Options"),h=X("Listbox.Options"),A=Ce(o.optionsElement),k=ke(),[P,R]=_e(O,g,k!==null?(k&J.Open)===J.Open:o.listboxState===0);Fe(P,o.buttonElement,h.closeListbox);let L=o.__demoMode?!1:s&&o.listboxState===0;Ae(L,A);let w=o.__demoMode?!1:s&&o.listboxState===0;Be(w,{allowed:d.useCallback(()=>[o.buttonElement,o.optionsElement],[o.buttonElement,o.optionsElement])});let E=o.listboxState!==0,_=Ne(E,o.buttonElement)?!1:P,F=P&&o.listboxState===1,b=ve(F,o.value),D=m(l=>o.compare(b,l)),r=d.useMemo(()=>{var l;if(c==null||!((l=c==null?void 0:c.to)!=null&&l.includes("selection")))return null;let M=o.options.findIndex(Q=>D(Q.dataRef.current.value));return M===-1&&(M=0),M},[c,o.options]),N=(()=>{if(c==null)return;if(r===null)return{...c,inner:void 0};let l=Array.from(o.listRef.current.values());return{...c,inner:{listRef:{current:l},index:r}}})(),[W,Y]=Qe(N),ee=Ke(),te=G(n,c?W:null,h.setOptionsElement,v),j=fe();d.useEffect(()=>{var l;let M=o.optionsElement;M&&o.listboxState===0&&M!==((l=Ve(M))==null?void 0:l.activeElement)&&(M==null||M.focus({preventScroll:!0}))},[o.listboxState,o.optionsElement]);let q=m(l=>{var M,Q;switch(j.dispose(),l.key){case I.Space:if(o.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),h.search(l.key);case I.Enter:if(l.preventDefault(),l.stopPropagation(),o.activeOptionIndex!==null){let{dataRef:ie}=o.options[o.activeOptionIndex];h.onChange(ie.current.value)}o.mode===0&&(B.flushSync(()=>h.closeListbox()),(M=o.buttonElement)==null||M.focus({preventScroll:!0}));break;case K(o.orientation,{vertical:I.ArrowDown,horizontal:I.ArrowRight}):return l.preventDefault(),l.stopPropagation(),h.goToOption($.Next);case K(o.orientation,{vertical:I.ArrowUp,horizontal:I.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),h.goToOption($.Previous);case I.Home:case I.PageUp:return l.preventDefault(),l.stopPropagation(),h.goToOption($.First);case I.End:case I.PageDown:return l.preventDefault(),l.stopPropagation(),h.goToOption($.Last);case I.Escape:l.preventDefault(),l.stopPropagation(),B.flushSync(()=>h.closeListbox()),(Q=o.buttonElement)==null||Q.focus({preventScroll:!0});return;case I.Tab:l.preventDefault(),l.stopPropagation(),B.flushSync(()=>h.closeListbox()),lt(o.buttonElement,l.shiftKey?ce.Previous:ce.Next);break;default:l.key.length===1&&(h.search(l.key),j.setTimeout(()=>h.clearSearch(),350));break}}),ne=(a=o.buttonElement)==null?void 0:a.id,oe=d.useMemo(()=>({open:o.listboxState===0}),[o.listboxState]),V=pe(c?ee():{},{id:x,ref:te,"aria-activedescendant":o.activeOptionIndex===null||(t=o.options[o.activeOptionIndex])==null?void 0:t.id,"aria-multiselectable":o.mode===1?!0:void 0,"aria-labelledby":ne,"aria-orientation":o.orientation,onKeyDown:q,role:"listbox",tabIndex:o.listboxState===0?0:void 0,style:{...u.style,...Y,"--button-width":Ge(o.buttonElement,!0).width},...Ue(R)}),ae=H();return T.createElement(He,{enabled:p?e.static||P:!1},T.createElement(Z.Provider,{value:o.mode===1?o:{...o,isSelected:D}},ae({ourProps:V,theirProps:u,slot:oe,defaultTag:ht,features:Et,visible:_,name:"Listbox.Options"})))}let Rt="div";function yt(e,n){let a=d.useId(),{id:t=`headlessui-listbox-option-${a}`,disabled:i=!1,value:x,...S}=e,p=d.useContext(be)===!0,s=z("Listbox.Option"),O=X("Listbox.Option"),u=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===t:!1,c=s.isSelected(x),g=d.useRef(null),v=ze(g),o=je({disabled:i,value:x,domRef:g,get textValue(){return v()}}),h=G(n,g,b=>{b?s.listRef.current.set(t,b):s.listRef.current.delete(t)});se(()=>{if(!s.__demoMode&&s.listboxState===0&&u&&s.activationTrigger!==0)return qe().requestAnimationFrame(()=>{var b,D;(D=(b=g.current)==null?void 0:b.scrollIntoView)==null||D.call(b,{block:"nearest"})})},[g,u,s.__demoMode,s.listboxState,s.activationTrigger,s.activeOptionIndex]),se(()=>{if(!p)return O.registerOption(t,o)},[o,t,p]);let A=m(b=>{var D;if(i)return b.preventDefault();O.onChange(x),s.mode===0&&(B.flushSync(()=>O.closeListbox()),(D=s.buttonElement)==null||D.focus({preventScroll:!0}))}),k=m(()=>{if(i)return O.goToOption($.Nothing);O.goToOption($.Specific,t)}),P=Je(),R=m(b=>{P.update(b),!i&&(u||O.goToOption($.Specific,t,0))}),L=m(b=>{P.wasMoved(b)&&(i||u||O.goToOption($.Specific,t,0))}),w=m(b=>{P.wasMoved(b)&&(i||u&&O.goToOption($.Nothing))}),E=d.useMemo(()=>({active:u,focus:u,selected:c,disabled:i,selectedOption:c&&p}),[u,c,i,p]),_=p?{}:{id:t,ref:h,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":c,disabled:void 0,onClick:A,onFocus:k,onPointerEnter:R,onMouseEnter:R,onPointerMove:L,onMouseMove:L,onPointerLeave:w,onMouseLeave:w},F=H();return!c&&p?null:F({ourProps:_,theirProps:S,slot:E,defaultTag:Rt,name:"Listbox.Option"})}let It=d.Fragment;function Pt(e,n){let{options:a,placeholder:t,...i}=e,x={ref:G(n)},S=z("ListboxSelectedOption"),p=d.useMemo(()=>({}),[]),s=S.value===void 0||S.value===null||S.mode===1&&Array.isArray(S.value)&&S.value.length===0,O=H();return T.createElement(be.Provider,{value:!0},O({ourProps:x,theirProps:{...i,children:T.createElement(T.Fragment,null,t&&s?t:a)},slot:p,defaultTag:It,name:"ListboxSelectedOption"}))}let Lt=U(Ot),Mt=U(gt),Tt=Ee,Dt=U($t),wt=U(yt),Ct=U(Pt),At=Object.assign(Lt,{Button:Mt,Label:Tt,Options:Dt,Option:wt,SelectedOption:Ct});export{Dt as G,At as M,Mt as N,wt as V,Ft as f,ve as l};
