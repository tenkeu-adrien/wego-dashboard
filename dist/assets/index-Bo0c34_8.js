import{a as x,j as e,y as p}from"./index-GijbQdYS.js";import{G as u}from"./iconBase-DdbS4CjZ.js";/* empty css                      */function B(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(t)}function R(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(t)}function T(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(t)}function D(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(t)}function K(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"5",x2:"5",y2:"19"},child:[]},{tag:"circle",attr:{cx:"6.5",cy:"6.5",r:"2.5"},child:[]},{tag:"circle",attr:{cx:"17.5",cy:"17.5",r:"2.5"},child:[]}]})(t)}function W(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(t)}function O(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(t)}function $(){const t=[{id:1,name:"Moto-taxi",icon:"üèçÔ∏è",availableForDelivery:!0},{id:2,name:"Trycycle",icon:"üõ∫",availableForDelivery:!1}],n={basePrice:1500,pricePerKm:500,peakHoursMultiplier:1.5,deliveryFee:2e3,commissionRate:10},[o,f]=x.useState({}),[L,h]=x.useState(null),[y,S]=x.useState([]),[l,j]=x.useState("course"),[E,H]=x.useState(!0),[b,v]=x.useState({});x.useEffect(()=>{(async()=>{try{const s=await fetch("https://wegoadmin-c5c82e2c5d80.herokuapp.com/api/v1/pricing");if(!s.ok)throw new Error("Erreur r√©seau");const a=await s.json(),i=t.reduce((c,m)=>({...c,[m.id]:a[m.id]||{...n,selectedDuration:null}}),{});f(i)}catch(s){console.error("Erreur lors du chargement des tarifs:",s),p.error("Erreur lors du chargement des tarifs",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{H(!1)}})()},[]);const M=async r=>{v(s=>({...s,[r]:!0}));try{const s=o[r]||n;if(s.commissionRate<0||s.commissionRate>100)throw new Error("Le taux de commission doit √™tre entre 0 et 100%");if(!(await fetch(`https://wegoadmin-c5c82e2c5d80.herokuapp.com/api/v1/pricing/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Erreur lors de la sauvegarde");S(i=>[{date:new Date().toLocaleString(),vehicle:t.find(c=>c.id===r).name,changes:s},...i.slice(0,9)]),h(null),p.success("Tarifs mis √† jour avec succ√®s",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(s){console.error("Erreur lors de la sauvegarde:",s),p.error(s.message||"Erreur lors de la sauvegarde",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{v(s=>({...s,[r]:!1}))}},A=(r,s)=>{const a=o[r]||n;let i,c;l==="livraison"?i=a.deliveryFee:i=a.basePrice+a.pricePerKm*s,c=i*(a.commissionRate/100);const m=i-c;return{total:i.toLocaleString(),commission:c.toLocaleString(),driverEarnings:m.toLocaleString()}},g=(r,s,a)=>{f(i=>({...i,[r]:{...i[r],[s]:a===""?"":s==="peakHoursMultiplier"?parseFloat(a)||0:parseInt(a)||0}}))};return E?e.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700",children:"Chargement des tarifs..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Gestion des Tarifs et Commissions"}),e.jsx("p",{className:"text-gray-600",children:"Configurez les prix et commissions par type de v√©hicule"})]}),e.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[e.jsxs("button",{onClick:()=>j("course"),className:`px-4 py-2 font-medium flex items-center ${l==="course"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(R,{className:"mr-2"})," Courses"]}),e.jsxs("button",{onClick:()=>j("livraison"),className:`px-4 py-2 font-medium flex items-center ${l==="livraison"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(D,{className:"mr-2"})," Livraisons"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:t.filter(r=>l==="course"||l==="livraison"&&r.availableForDelivery).map(r=>{var a,i,c,m,N,w,k,C,F,P;const s=A(r.id,10);return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"bg-green-600 p-4 text-white flex items-center",children:[e.jsx("span",{className:"text-2xl mr-3",children:r.icon}),e.jsx("span",{className:"font-semibold text-lg",children:r.name})]}),e.jsx("div",{className:"p-5",children:L===r.id?e.jsxs("div",{className:"space-y-4",children:[l==="course"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix de base (1h)"}),e.jsx("input",{type:"number",min:"0",value:((a=o[r.id])==null?void 0:a.basePrice)??n.basePrice,onChange:d=>g(r.id,"basePrice",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix par km"}),e.jsx("input",{type:"number",min:"0",value:((i=o[r.id])==null?void 0:i.pricePerKm)??n.pricePerKm,onChange:d=>g(r.id,"pricePerKm",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]}),l==="livraison"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frais de livraison"}),e.jsx("input",{type:"number",min:"0",value:((c=o[r.id])==null?void 0:c.deliveryFee)??n.deliveryFee,onChange:d=>g(r.id,"deliveryFee",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Commission (%)"}),e.jsxs("div",{className:"relative rounded-md shadow-sm",children:[e.jsx("input",{type:"number",min:"0",max:"100",value:((m=o[r.id])==null?void 0:m.commissionRate)??n.commissionRate,onChange:d=>g(r.id,"commissionRate",d.target.value),className:"block w-full pr-12 pl-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx(K,{className:"text-gray-500"})})]})]}),l==="course"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Majoration heures de pointe"}),e.jsxs("select",{value:((N=o[r.id])==null?void 0:N.peakHoursMultiplier)??n.peakHoursMultiplier,onChange:d=>g(r.id,"peakHoursMultiplier",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"1.0",children:"Aucune (x1.0)"}),e.jsx("option",{value:"1.2",children:"Standard (x1.2)"}),e.jsx("option",{value:"1.5",children:"√âlev√©e (x1.5)"})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-2",children:[e.jsx("button",{onClick:()=>h(null),className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 transition flex items-center justify-center",children:"Annuler"}),e.jsx("button",{onClick:()=>M(r.id),disabled:b[r.id],className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition flex items-center justify-center",children:b[r.id]?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2"}),"Enregistrer"]})})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[l==="course"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Prix de base (1h):"}),e.jsxs("span",{className:"font-medium",children:[(((w=o[r.id])==null?void 0:w.basePrice)??n.basePrice).toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Prix par km:"}),e.jsxs("span",{className:"font-medium",children:[(((k=o[r.id])==null?void 0:k.pricePerKm)??n.pricePerKm).toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Heures de pointe:"}),e.jsxs("span",{className:"font-medium",children:["x",((C=o[r.id])==null?void 0:C.peakHoursMultiplier)??n.peakHoursMultiplier]})]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Frais livraison:"}),e.jsxs("span",{className:"font-medium",children:[(((F=o[r.id])==null?void 0:F.deliveryFee)??n.deliveryFee).toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Commission:"}),e.jsxs("span",{className:"font-medium",children:[((P=o[r.id])==null?void 0:P.commissionRate)??n.commissionRate,"%"]})]})]}),e.jsxs("button",{onClick:()=>h(r.id),className:"w-full mt-4 border border-green-600 text-green-600 py-2 rounded-md flex items-center justify-center hover:bg-green-50 transition",children:[e.jsx(T,{className:"mr-2"})," Modifier les tarifs"]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(O,{className:"mr-2"}),l==="livraison"?"Simulation de livraison":"Simulation pour 10km"]}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{className:"text-gray-600",children:"Total:"}),e.jsxs("div",{className:"font-medium text-right",children:[s.total," FCFA"]}),e.jsx("div",{className:"text-gray-600",children:"Commission:"}),e.jsxs("div",{className:"font-medium text-right",children:[s.commission," FCFA"]}),e.jsx("div",{className:"text-gray-600",children:"Gains conducteur:"}),e.jsxs("div",{className:"font-medium text-right text-green-600",children:[s.driverEarnings," FCFA"]})]})})]})]})})]},r.id)})}),e.jsx("div",{className:"mt-12 bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:e.jsxs("div",{className:"bg-white p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(B,{className:"mr-2"})," Historique des modifications"]}),y.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"V√©hicule"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"D√©tails"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((r,s)=>e.jsxs("tr",{className:s%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.date}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:r.vehicle}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:l==="course"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Base: ",r.changes.basePrice," FCFA"]}),e.jsxs("div",{children:["Prix/km: ",r.changes.pricePerKm," FCFA"]}),e.jsxs("div",{children:["Commission: ",r.changes.commissionRate,"%"]})]}):e.jsxs("div",{children:["Livraison: ",r.changes.deliveryFee," FCFA"]})})]},s))})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 italic",children:"Aucune modification enregistr√©e"})})]})})]})}export{$ as default};
